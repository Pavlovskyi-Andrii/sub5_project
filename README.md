# Garmin Connect to Google Sheets Sync

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏–∑ Garmin Connect –≤ Google –¢–∞–±–ª–∏—Ü—ã.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏–∑ Garmin Connect
- üö¥ –í–µ–ª–æ—Å–∏–ø–µ–¥–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: –≤–∞—Ç—ã, Normalized Power, —Å–∫–æ—Ä–æ—Å—Ç—å, –∫–∞–¥–µ–Ω—Å, –ß–°–°
- üèÉ –ë–µ–≥–æ–≤—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: –≤—Ä–µ–º—è, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, —Ç–µ–º–ø, –ß–°–°
- üìà –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Google –¢–∞–±–ª–∏—Ü—ã
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ Service Account –≤ Google Cloud

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ Google Sheets API
4. –°–æ–∑–¥–∞–π—Ç–µ Service Account:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "IAM & Admin" ‚Üí "Service Accounts"
   - –ù–∞–∂–º–∏—Ç–µ "Create Service Account"
   - –î–∞–π—Ç–µ –∏–º—è –∏ —Å–æ–∑–¥–∞–π—Ç–µ
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç ‚Üí "Keys" ‚Üí "Add Key" ‚Üí "Create New Key" ‚Üí JSON
   - –°–∫–∞—á–∞–π—Ç–µ JSON —Ñ–∞–π–ª

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Google –¢–∞–±–ª–∏—Ü—É

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é Google –¢–∞–±–ª–∏—Ü—É –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL —Ç–∞–±–ª–∏—Ü—ã
3. –û—Ç–∫—Ä–æ–π—Ç–µ JSON —Ñ–∞–π–ª service account –∏ –Ω–∞–π–¥–∏—Ç–µ email (–Ω–∞–ø—Ä–∏–º–µ—Ä: `xxx@xxx.iam.gserviceaccount.com`)
4. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å —ç—Ç–∏–º email (–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Replit

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ Replit Secrets:

- `GARMIN_EMAIL` - –≤–∞—à email –æ—Ç Garmin Connect
- `GARMIN_PASSWORD` - –≤–∞—à –ø–∞—Ä–æ–ª—å –æ—Ç Garmin Connect
- `GOOGLE_SHEET_URL` - URL –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü—ã
- `SERVICE_ACCOUNT_JSON` - —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ JSON —Ñ–∞–π–ª–∞ service account (–≤–µ—Å—å —Ç–µ–∫—Å—Ç)
- `DAYS_TO_SYNC` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7)

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç

```bash
python main.py
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –õ–∏—Å—Ç "–í–µ–ª" (–í–µ–ª–æ—Å–∏–ø–µ–¥)
- –î–∞—Ç–∞
- –°—Ä–µ–¥–Ω–∏–µ –≤–∞—Ç—ã
- Normalized Power
- –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å (–∫–º/—á)
- –ß–∞—Å—Ç–æ—Ç–∞ –≤—Ä–∞—â–µ–Ω–∏—è (–∫–∞–¥–µ–Ω—Å)
- –°—Ä–µ–¥–Ω—è—è –ß–°–°
- –°—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- –ë–µ–≥ –±—Ä–∏–∫ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- –ß–°–° –±–µ–≥ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- TTV dist (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- TTV time (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- ActivityID (—Å–ª—É–∂–µ–±–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)

### –õ–∏—Å—Ç "–ë–µ–≥" (–ë–µ–≥)
- –î–∞—Ç–∞
- –í—Ä–µ–º—è (–ß–ß:–ú–ú:–°–°)
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–∫–º)
- –°—Ä–µ–¥–Ω–∏–π —Ç–µ–º–ø (–º–∏–Ω/–∫–º)
- –°—Ä–µ–¥–Ω—è—è –ß–°–°
- –£—Å—Ç–∞–ª–æ—Å—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–∏ –¥–Ω—è (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- –í–æ –≤—Ä–µ–º—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- –ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- TTR dist (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- TTR time (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- –í–∞—Ä–∏–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –°–† (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- ActivityID (—Å–ª—É–∂–µ–±–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "401 Unauthorized" –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Garmin

–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `GARMIN_EMAIL` –∏ `GARMIN_PASSWORD` —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ –Ω–∞ [connect.garmin.com](https://connect.garmin.com) –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Å —ç—Ç–∏–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ email —É–∫–∞–∑–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é (–≤–∫–ª—é—á–∞—è @gmail.com –∏–ª–∏ –¥—Ä—É–≥–æ–π –¥–æ–º–µ–Ω)

2. **–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA):**
   - –ï—Å–ª–∏ —É –≤–∞—Å –≤–∫–ª—é—á–µ–Ω–∞ 2FA –≤ Garmin, –µ—ë –Ω—É–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é (—Å–º. —Ä–∞–∑–¥–µ–ª –Ω–∏–∂–µ)

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
   - –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç `SESSION_SECRET`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ Replit Secrets –∫–∞–∫ `SESSION_SECRET`
   - –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –≥–æ–¥

4. **–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ email –æ—Ç Garmin –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
   - –ó–∞–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç Garmin –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω

5. **–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞:**
   - –ü–æ–¥–æ–∂–¥–∏—Ç–µ 15-30 –º–∏–Ω—É—Ç –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–æ–π
   - Garmin –º–æ–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö

### –ü—Ä–æ–±–ª–µ–º—ã —Å Google Sheets

–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–¥–µ–ª–∏–ª–∏—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å email –∏–∑ Service Account
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `SERVICE_ACCOUNT_JSON` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π JSON (–≤–∫–ª—é—á–∞—è —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Sheets API –≤–∫–ª—é—á–µ–Ω –≤ Google Cloud Console

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –ª–∏—Å—Ç—ã "–í–µ–ª" –∏ "–ë–µ–≥" –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è (—Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ, —É—Å—Ç–∞–ª–æ—Å—Ç—å –∏ —Ç.–¥.) –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –≤—Ä—É—á–Ω—É—é –≤ —Ç–∞–±–ª–∏—Ü–µ
- Normalized Power –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
- –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Garmin, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã - –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±–µ–∑ —Ä–∏—Å–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Ö –∂–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –æ–¥–∏–Ω –¥–µ–Ω—å (—Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –ø–æ ActivityID)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –¥–Ω–∏ (–ø–∞—Ä–∞–º–µ—Ç—Ä DAYS_TO_SYNC)
